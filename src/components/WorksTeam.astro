---
interface Driver {
  name: string;
  carNumber: number | string;
  nationality: string;
  natImgUrl?: string;
  carImgUrl: string;
}

const drivers: Driver[] = [
  {
    name: "Jeremy Cubbage",
    carNumber: 33,
    nationality: "United States",
    natImgUrl: "/src/assets/flags/United States.png",
    carImgUrl: "/src/assets/cars/car-756.png",
  },
  {
    name: "Andrew Casey",
    carNumber: 406,
    nationality: "United States",
    natImgUrl: "/src/assets/flags/United States.png",
    carImgUrl: "/src/assets/cars/car-406.png",
  },
  {
    name: "Zach Schneider",
    carNumber: 15,
    nationality: "Canada",
    natImgUrl: "/src/assets/flags/Canada.png",
    carImgUrl: "/src/assets/cars/car-15.png",
  },
  {
    name: "Nico Menendez",
    carNumber: 756,
    nationality: "Argentina",
    natImgUrl: "/src/assets/flags/Argentina.png",
    carImgUrl: "/src/assets/cars/car-756.png",
  },
  {
    name: "Adam Turaj",
    carNumber: 6,
    nationality: "Canada",
    natImgUrl: "/src/assets/flags/Canada.png",
    carImgUrl: "/src/assets/cars/car-6.png",
  },
  {
    name: "Casey Swanseger",
    carNumber: 84,
    nationality: "United States",
    natImgUrl: "/src/assets/flags/United States.png",
    carImgUrl: "/src/assets/cars/car-84.png",
  },
  {
    name: "Casey Swanseger",
    carNumber: 84,
    nationality: "United States",
    natImgUrl: "/src/assets/flags/United States.png",
    carImgUrl: "/src/assets/cars/car-84.png",
  },
  {
    name: "Casey Swanseger",
    carNumber: 84,
    nationality: "United States",
    natImgUrl: "/src/assets/flags/United States.png",
    carImgUrl: "/src/assets/cars/car-84.png",
  },
  {
    name: "Casey Swanseger",
    carNumber: 84,
    nationality: "United States",
    natImgUrl: "/src/assets/flags/United States.png",
    carImgUrl: "/src/assets/cars/car-84.png",
  },
  {
    name: "Casey Swanseger",
    carNumber: 84,
    nationality: "United States",
    natImgUrl: "/src/assets/flags/United States.png",
    carImgUrl: "/src/assets/cars/car-84.png",
  },
  {
    name: "Casey Swanseger",
    carNumber: 84,
    nationality: "United States",
    natImgUrl: "/src/assets/flags/United States.png",
    carImgUrl: "/src/assets/cars/car-84.png",
  },
  {
    name: "Casey Swanseger",
    carNumber: 84,
    nationality: "United States",
    natImgUrl: "/src/assets/flags/United States.png",
    carImgUrl: "/src/assets/cars/car-84.png",
  },
  {
    name: "Casey Swanseger",
    carNumber: 84,
    nationality: "United States",
    natImgUrl: "/src/assets/flags/United States.png",
    carImgUrl: "/src/assets/cars/car-84.png",
  },
  {
    name: "Casey Swanseger",
    carNumber: 84,
    nationality: "United States",
    natImgUrl: "/src/assets/flags/United States.png",
    carImgUrl: "/src/assets/cars/car-84.png",
  },
  {
    name: "Casey Swanseger",
    carNumber: 84,
    nationality: "United States",
    natImgUrl: "/src/assets/flags/United States.png",
    carImgUrl: "/src/assets/cars/car-84.png",
  },
  {
    name: "Casey Swanseger",
    carNumber: 84,
    nationality: "United States",
    natImgUrl: "/src/assets/flags/United States.png",
    carImgUrl: "/src/assets/cars/car-84.png",
  },
  {
    name: "Casey Swanseger",
    carNumber: 84,
    nationality: "United States",
    natImgUrl: "/src/assets/flags/United States.png",
    carImgUrl: "/src/assets/cars/car-84.png",
  },
];
---

<section
  id="team"
  class="relative w-full min-h-[80vh] flex justify-center items-center px-6 md:px-12 lg:px-24 py-20 bg-gray-900/30 overflow-hidden"
>
  <div
    class="absolute inset-0 bg-[url('/src/assets/Hexagon_smaller.webp')] bg-cover bg-center opacity-10 blur-sm scale-110"
  >
  </div>
  <div class="container mx-auto px-4 relative z-10 max-w-7xl">
    <h2 class="text-4xl md:text-5xl font-bold text-white text-center mb-16">
      Our Works Team
    </h2>
    <div
      class="grid grid-cols-1 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-8 items-center"
    >
      <div
        id="car-display"
        class="flex flex-col justify-center items-center min-h-[400px] md:min-h-[500px] bg-gray-800/70 rounded-2xl p-4 md:p-12 border-2 border-purple-500/30 hover:border-purple-500/50 transition-all duration-300 shadow-xl shadow-purple-500/10"
      >
        <img
          id="car-image"
          src={drivers[0].carImgUrl}
          alt={`Car #${drivers[0].carNumber}`}
          class="w-full md:w-auto md:scale-115 h-auto rounded-lg transition-opacity duration-300"
        />
        <h4
          class="text-2xl md:text-3xl text-white transition-opacity duration-300 mt-4 md:mt-6 font-bold"
        >
          {drivers[0].name}
        </h4>
        <small
          class="text-gray-300 transition-opacity duration-300 mt-2 text-base"
          ><img
            src={drivers[0].natImgUrl}
            alt={drivers[0].nationality}
            class="inline w-6 h-4 mr-2"
          />{drivers[0].nationality}</small
        >
      </div>
      <div class="col-span-1 mx-auto transition-all duration-300">
        <div
          id="drivers-container"
          class="flex justify-center items-center flex-wrap gap-6 p-8"
        >
          {
            drivers.map((driver, index) => (
              <button
                data-car-img={driver.carImgUrl}
                data-car-number={driver.carNumber}
                data-driver-name={driver.name}
                data-nationality={driver.nationality}
                data-flag={driver.natImgUrl}
                data-index={index}
                class={`driver-btn flex justify-center items-center bg-linear-135 from-yellow-500/50 to-purple-900 border border-purple-950 font-semibold text-2xl w-20 aspect-square rounded-full shadow-lg overflow-hidden hover:scale-105 hover:bg-yellow-500 transform transition duration-300 ${index === 0 ? "ring-2 ring-purple-600 bg-yellow-500" : ""}`}
              >
                <p>{driver.carNumber}</p>
              </button>
            ))
          }
        </div>
        <!-- Pagination controls for mobile -->
        <div
          id="pagination-controls"
          class="flex md:hidden justify-center items-center gap-4 mt-6"
        >
          <button
            id="prev-page"
            class="bg-gray-700 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-full disabled:opacity-30 disabled:cursor-not-allowed transition-all"
            aria-label="Previous page"
          >
            <svg
              class="w-5 h-5"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M15 19l-7-7 7-7"></path>
            </svg>
          </button>
          <span id="page-indicator" class="text-white font-semibold">1 / 1</span
          >
          <button
            id="next-page"
            class="bg-gray-700 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-full disabled:opacity-30 disabled:cursor-not-allowed transition-all"
            aria-label="Next page"
          >
            <svg
              class="w-5 h-5"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M9 5l7 7-7 7"></path>
            </svg>
          </button>
        </div>
      </div>
    </div>
  </div>
</section>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const carImage = document.getElementById("car-image") as HTMLImageElement;
    const driverButtons = document.querySelectorAll(".driver-btn");

    driverButtons.forEach((button) => {
      button.addEventListener("click", () => {
        const carImg = button.getAttribute("data-car-img");
        const carNumber = button.getAttribute("data-car-number");
        const driverName = button.getAttribute("data-driver-name");
        const nationality = button.getAttribute("data-nationality");
        const flag = button.getAttribute("data-flag");

        const driverNameElement = document.querySelector(
          "#car-display h4"
        ) as HTMLElement;
        const nationalityElement = document.querySelector(
          "#car-display small img"
        ) as HTMLImageElement;
        const nationalityTextElement = document.querySelector(
          "#car-display small"
        ) as HTMLElement;

        if (carImage && carImg && driverName && nationality && flag) {
          // Fade out all elements
          carImage.style.opacity = "0";
          if (driverNameElement) {
            driverNameElement.style.opacity = "0";
          }
          if (nationalityTextElement) {
            nationalityTextElement.style.opacity = "0";
          }

          setTimeout(() => {
            // Update content
            carImage.src = carImg;
            carImage.alt = `Car #${carNumber}`;

            if (driverNameElement) {
              driverNameElement.textContent = driverName;
            }
            if (nationalityElement) {
              nationalityElement.src = flag;
              nationalityElement.alt = nationality;
            }
            if (nationalityTextElement) {
              const textNode = nationalityTextElement.childNodes[1];
              if (textNode) {
                textNode.nodeValue = nationality;
              }
            }

            // Fade in all elements
            carImage.style.opacity = "1";
            if (driverNameElement) {
              driverNameElement.style.opacity = "1";
            }
            if (nationalityTextElement) {
              nationalityTextElement.style.opacity = "1";
            }
          }, 150);
        }

        // Update active ring
        driverButtons.forEach((btn) => {
          btn.classList.remove("ring-2", "ring-purple-600", "bg-yellow-500");
        });
        button.classList.add("ring-2", "ring-purple-600", "bg-yellow-500");
      });
    });

    // Pagination for mobile
    const driversPerPage = 6;
    let currentPage = 0;
    const totalDrivers = driverButtons.length;
    const totalPages = Math.ceil(totalDrivers / driversPerPage);

    const prevBtn = document.getElementById("prev-page");
    const nextBtn = document.getElementById("next-page");
    const pageIndicator = document.getElementById("page-indicator");

    function updatePagination() {
      // Hide all buttons first
      driverButtons.forEach((btn, index) => {
        const button = btn as HTMLElement;
        const start = currentPage * driversPerPage;
        const end = start + driversPerPage;

        if (window.innerWidth < 768) {
          // Mobile: show only current page
          if (index >= start && index < end) {
            button.style.display = "flex";
          } else {
            button.style.display = "none";
          }
        } else {
          // Desktop: show all
          button.style.display = "flex";
        }
      });

      // Update page indicator
      if (pageIndicator) {
        pageIndicator.textContent = `${currentPage + 1} / ${totalPages}`;
      }

      // Update button states
      if (prevBtn) {
        (prevBtn as HTMLButtonElement).disabled = currentPage === 0;
      }
      if (nextBtn) {
        (nextBtn as HTMLButtonElement).disabled =
          currentPage === totalPages - 1;
      }
    }

    if (prevBtn) {
      prevBtn.addEventListener("click", () => {
        if (currentPage > 0) {
          currentPage--;
          updatePagination();
        }
      });
    }

    if (nextBtn) {
      nextBtn.addEventListener("click", () => {
        if (currentPage < totalPages - 1) {
          currentPage++;
          updatePagination();
        }
      });
    }

    // Update on resize
    window.addEventListener("resize", () => {
      updatePagination();
    });

    // Initial update
    updatePagination();
  });
</script>
