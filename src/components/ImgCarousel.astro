---
import img1 from "/src/assets/756nords.png";
import img2 from "/src/assets/carsfrombehind.jpg";
import img3 from "/src/assets/cotabattle.jpg";
---

<!-- Image Carousel -->
<div
  id="mission-carousel"
  class="relative w-full h-[400px] md:h-[500px] bg-gray-700 rounded-lg overflow-hidden"
>
  <div class="carousel w-full h-full">
    <!-- Carousel slides -->
    <div
      class="carousel-item w-full h-full transition-opacity duration-500"
      data-slide="0"
    >
      <img
        src={img1.src}
        alt="Racing at Nords"
        class="w-full h-full object-cover"
      />
    </div>
    <div
      class="carousel-item w-full h-full hidden transition-opacity duration-500"
      data-slide="1"
    >
      <img
        src={img2.src}
        alt="Cars from behind"
        class="w-full h-full object-cover"
      />
    </div>
    <div
      class="carousel-item w-full h-full hidden transition-opacity duration-500"
      data-slide="2"
    >
      <img
        src={img3.src}
        alt="COTA Battle"
        class="w-full h-full object-cover"
      />
    </div>
  </div>

  <!-- Left chevron -->
  <button
    id="carousel-prev"
    class="absolute left-4 top-1/2 transform -translate-y-1/2 z-10 bg-gray-400/15 hover:bg-gray-400/50 rounded-full p-2 transition-all"
    aria-label="Previous slide"
  >
    <svg
      class="w-6 h-6 text-white"
      fill="none"
      stroke="currentColor"
      viewBox="0 0 24 24"
    >
      <path
        stroke-linecap="round"
        stroke-linejoin="round"
        stroke-width="2"
        d="M15 19l-7-7 7-7"></path>
    </svg>
  </button>

  <!-- Right chevron -->
  <button
    id="carousel-next"
    class="absolute right-4 top-1/2 transform -translate-y-1/2 z-10 bg-gray-400/15 hover:bg-gray-400/50 rounded-full p-2 transition-all"
    aria-label="Next slide"
  >
    <svg
      class="w-6 h-6 text-white"
      fill="none"
      stroke="currentColor"
      viewBox="0 0 24 24"
    >
      <path
        stroke-linecap="round"
        stroke-linejoin="round"
        stroke-width="2"
        d="M9 5l7 7-7 7"></path>
    </svg>
  </button>

  <!-- Carousel navigation dots -->
  <div
    class="absolute bottom-4 left-1/2 transform -translate-x-1/2 flex gap-2 z-10"
  >
    <button
      class="carousel-dot w-3 h-3 rounded-full bg-white opacity-75 hover:opacity-100 transition-opacity"
      data-slide="0"></button>
    <button
      class="carousel-dot w-3 h-3 rounded-full bg-white opacity-50 hover:opacity-75 transition-opacity"
      data-slide="1"></button>
    <button
      class="carousel-dot w-3 h-3 rounded-full bg-white opacity-50 hover:opacity-75 transition-opacity"
      data-slide="2"></button>
  </div>
</div>

<!-- Script for Carousel functionality -->
<script>
  document.addEventListener("DOMContentLoaded", () => {
    const carousel = document.getElementById("mission-carousel");
    if (!carousel) return;

    const slides = carousel.querySelectorAll(".carousel-item");
    const dots = carousel.querySelectorAll(".carousel-dot");
    const prevBtn = document.getElementById("carousel-prev");
    const nextBtn = document.getElementById("carousel-next");
    let currentSlide = 0;
    const totalSlides = slides.length;

    function showSlide(index: number) {
      // Hide all slides
      slides.forEach((slide) => {
        slide.classList.add("hidden");
      });

      // Show current slide
      slides[index].classList.remove("hidden");

      // Update dots
      dots.forEach((dot, i) => {
        if (i === index) {
          dot.classList.remove("opacity-50");
          dot.classList.add("opacity-75");
        } else {
          dot.classList.remove("opacity-75");
          dot.classList.add("opacity-50");
        }
      });

      currentSlide = index;
    }

    function nextSlide() {
      const next = (currentSlide + 1) % totalSlides;
      showSlide(next);
    }

    function prevSlide() {
      const prev = (currentSlide - 1 + totalSlides) % totalSlides;
      showSlide(prev);
    }

    // Add click handlers to dots
    dots.forEach((dot, index) => {
      dot.addEventListener("click", () => {
        showSlide(index);
      });
    });

    // Add click handlers to chevrons
    prevBtn?.addEventListener("click", () => {
      prevSlide();
    });

    nextBtn?.addEventListener("click", () => {
      nextSlide();
    });
  });
</script>
